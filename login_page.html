<!DOCTYPE html>
<html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<head>
    <script>
        function login() {
            var transdata = {
                'username': document.getElementById("login_username").value,
                'password': document.getElementById("login_password").value
            };

            //temp is a temporary value of feedback
            var feedback = fetch("nss.php?do=login", {
                    method: 'post',
                    body: JSON.stringify(transdata),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(res => res.json());

            alert(feedback);

            //If not pass
            if (feedback.token == '0') {
                alert("Wrong username or password")
                window.location.href = "login_page.html";
                return "Login Fail";
            }

            //Get the time and set for 2 hours access
            var date = new Date();
            date.setTime(date.getTime() + (2 * 60 * 60 * 1000));

            //Get token

            var token = feedback.token[Object.keys(feedback.token)[1]];

            //Set cookie
            document.cookie = "Token=" + token + "; expires=" + date.toGMTString();

            return "Login Success";
        }
    </script>
</head>

<body>
    <form action="" method="POST" id="login_info" onsubmit="login()">
        Username:<br>
        <input type="text" name="username" value="" id="login_username">
        <br> Password:<br>
        <input type="password" name="password" value="" id="login_password">
        <br><br>
        <input type="submit" value="Submit">
    </form>
</body>

</html>